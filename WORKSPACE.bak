# WORKSPACE
workspace(name = "pyguardqa")

# Standard http_archive load for external repositories
load("@bazel_tools//tools/build_defs/repo:http.bzl", "http_archive")

# --- Explicitly define bazel_skylib ---
# (SHA256 confirmed from your earlier output)
http_archive(
    name = "bazel_skylib",
    sha256 = "66ffd9315665bfaafc96b52278f57c7e2dd09f5ede279ea6d39b2be471e7e3aa", # Correct SHA256 for 1.4.2
    urls = [
        "https://mirror.bazel.build/github.com/bazelbuild/bazel-skylib/releases/download/1.4.2/bazel-skylib-1.4.2.tar.gz",
        "https://github.com/bazelbuild/bazel-skylib/releases/download/1.4.2/bazel-skylib-1.4.2.tar.gz",
    ],
)

# --- Explicitly define rules_python_internal ---
# It uses the SAME archive as rules_python, but needs its own definition
# to be discoverable by rules_python's internal logic.
# (SHA256 confirmed from your last error output for rules_python-0.40.0.tar.gz)
http_archive(
    name = "rules_python_internal",
    sha256 = "690e0141724abb568267e003c7b6d9a54925df40c275a870a4d934161dc9dd53", # Correct SHA256 for 0.40.0
    strip_prefix = "rules_python-0.40.0",
    url = "https://github.com/bazel-contrib/rules_python/releases/download/0.40.0/rules_python-0.40.0.tar.gz",
)

# --- Define rules_python (0.40.0) ---
# (SHA256 confirmed from your last error output)
http_archive(
    name = "rules_python",
    sha256 = "690e0141724abb568267e003c7b6d9a54925df40c275a870a4d934161dc9dd53", # Correct SHA256 for 0.40.0
    strip_prefix = "rules_python-0.40.0",
    url = "https://github.com/bazel-contrib/rules_python/releases/download/0.40.0/rules_python-0.40.0.tar.gz",
)

# --- Register Python toolchains ---
# This looks for Python 3.10 on your system (or via PATH).
load("@rules_python//python:repositories.bzl", "python_register_toolchains")

python_register_toolchains(
    name = "python_3_10_toolchains",
    python_version = "3.10",
)

# --- Install pip dependencies ---
load("@rules_python//python:pip.bzl", "pip_install")

pip_install(
    name = "pip",
    requirements = "//:requirements.txt",
    python_version = "3.10",
)